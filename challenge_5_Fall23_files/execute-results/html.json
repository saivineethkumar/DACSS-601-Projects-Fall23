{
  "hash": "6c499eba8f358504d7cb92eceb16a6a8",
  "result": {
    "markdown": "---\ntitle: \"Challenge_5: Visualizing Time and Space\"\nauthor: \"Sai Vineeth Kumar Dara\"\ndescription: \"A Holloween Special - Challenge5 Submission\"\ndate: \"10/25/2023\"\nformat:\n  html:\n    df-print: paged\n    css: \"styles.css\"\n    embed-resources: true\n    self-contained-math: true\ncategories:\n  - weekly_challenges\n  - challenge_5\n---\n\n\n**Make sure you change the author's name in the above YAML header.**\n\n## Setup\n\nIf you have not installed the following packages, please install them before loading them.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readr)\nlibrary(readxl)\nlibrary(haven) #for loading other datafiles (SAS, STATA, SPSS, etc.)\n\n#for plotting time\nlibrary(ggplot2) # if you have not installed this package, please install it.\nlibrary(lubridate)\n\n\n#for plotting space\nlibrary(sp)\nlibrary(sf)\nlibrary(maps)\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(gganimate)\nlibrary(gifski)\n\nknitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)\n```\n:::\n\n\n## Challenge Overview\n\n![Halloween2023](https://im.indiatimes.in/content/2023/Aug/halloween-2023-date1_64d222bb35bee.jpg?w=1100&h=535&cc=1){fig-align=\"center\" width=\"431\"}\n\nIn this challenge, we will practice the visualization skills learned in the class with two datasets to capture the temporal and spatial patterns of supernatural phenomena.\n\nThere will be coding components and writing components. Please read the instructions for each part and complete your challenges.\n\n## Datasets\n\n-   [Part 1. The UFO Sightings Data (50%)](#part-1.-the-ufo-sightings-data-50)\n-   [Part 2. The Haunted Places Data (50%)](#part-2.-the-haunted-places-data-50)\n\nFind the `_data` folder, then read the datasets using the correct R command.\n\n## Part 1. The UFO Sightings Data (50%) {#part-1.-the-ufo-sightings-data-50}\n\nThis data contains over 80,000 reports of UFO sightings over the last century in six major countries (and other places). You can learn more about this data by checking: <https://www.kaggle.com/datasets/NUFORC/ufo-sightings>.\n\n1.  **Read and Describe the Data (10%)**\n\n    What is the dimension of the data? What do the columns mean? What is the unit of observation?\\\n    **Answer:**\\\n    The dimension of the data is 88875x11.\\\n    \\\n    The following are the columns:\\\n    datetime - the date on which the ufo was sighted\\\n    city - the city in which the ufo was sighted\\\n    state- the state in which the ufo was sighted\\\n    country - the country in which the ufo was sighted\\\n    shape - the shape of the ufo\\\n    duration (seconds) - the duration in seconds for which the ufo was sighted\\\n    duration (hours/min) - the duration in minutes/hours for which the ufo was sighted\\\n    comments - comments regarding the sighting\\\n    date posted - the date on which the sighting was posted\\\n    latitude - latitude location of ufo spotted\\\n    longitude - longitude location of ufo spotted\\\n    \\\n    Here, the unit of observation is a UFO sighting instance. Each row is a case giving information about a ufo sighting e.g., location, duration etc.\\\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #type of your code/command here.\n    ufo_data <- read_csv(\"./challenge5_data/complete_UFO.csv\", show_col_types = FALSE)\n    \n    ufo_data <- ufo_data %>%\n      select(-`...12`)\n    \n    dim(ufo_data)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 88875    11\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    head(ufo_data)\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <div data-pagedtable=\"false\">\n      <script data-pagedtable-source type=\"application/json\">\n    {\"columns\":[{\"label\":[\"datetime\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"city\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"state\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"country\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"shape\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"duration (seconds)\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"duration (hours/min)\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"comments\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"date posted\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"latitude\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"longitude\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"11/11/1906\",\"2\":\"wien (austria)\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"other\",\"6\":\"10800\",\"7\":\"3 h\",\"8\":\"The oldest professional photo of a UFO object is from Wien observatory&#44 in 1906&#33\",\"9\":\"12/23/2002\",\"10\":\"48.208174\",\"11\":\"16.373819\"},{\"1\":\"1/2/1910\",\"2\":\"kirksville (near)\",\"3\":\"mo\",\"4\":\"us\",\"5\":\"disk\",\"6\":\"120\",\"7\":\"minutes\",\"8\":\"Historical sighting (1903 - 1913) Northern Missouri\",\"9\":\"9/15/2005\",\"10\":\"40.1947222\",\"11\":\"-92.583056\"},{\"1\":\"5/28/1910\",\"2\":\"solon\",\"3\":\"me\",\"4\":\"us\",\"5\":\"unknown\",\"6\":\"0\",\"7\":\"don&#39t know\",\"8\":\"entry in my great-grandmother&#39s diary&#44date 28 may 1910&#44refers to watching the comet zig-zaging in the sky&#44 followed by a zig-zag diagra\",\"9\":\"12/5/2001\",\"10\":\"44.9494444\",\"11\":\"-69.858889\"},{\"1\":\"6/1/1910\",\"2\":\"wills point\",\"3\":\"tx\",\"4\":\"us\",\"5\":\"cigar\",\"6\":\"120\",\"7\":\"2 minutes\",\"8\":\"Cigar shaped object moving from West to East\",\"9\":\"4/16/2005\",\"10\":\"32.7091667\",\"11\":\"-96.008056\"},{\"1\":\"9/15/1914\",\"2\":\"meeting lake (canada)\",\"3\":\"ab\",\"4\":\"NA\",\"5\":\"unknown\",\"6\":\"0\",\"7\":\"NA\",\"8\":\"Night flying &quot;airplane&quot; with search lights observed on several occasions near Meeting Lake&#44 Alberta in late 1914.\",\"9\":\"2/1/2007\",\"10\":\"55.170828\",\"11\":\"-118.837956\"},{\"1\":\"4/5/1916\",\"2\":\"france (above; from aircraft)\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"cigar\",\"6\":\"60\",\"7\":\"about 1 min.\",\"8\":\"((NUFORC Note:  Possible hoax.  PD))  Saw 3 cigar shaped crafts.\",\"9\":\"3/9/2004\",\"10\":\"46.227638\",\"11\":\"2.213749\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n      </script>\n    </div>\n    `````\n    :::\n    \n    ```{.r .cell-code}\n    colnames(ufo_data)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n     [1] \"datetime\"             \"city\"                 \"state\"               \n     [4] \"country\"              \"shape\"                \"duration (seconds)\"  \n     [7] \"duration (hours/min)\" \"comments\"             \"date posted\"         \n    [10] \"latitude\"             \"longitude\"           \n    ```\n    :::\n    :::\n\n\n<!-- -->\n\n2.  Please plot a temporal/time-series graph to present the following patterns. **You may need to subset or mutate the data for graphing.**\n\n    \\(1\\) the total number of UFO sighting reports over the years (date_break = year). **(15%)**\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #change the datetime column to Date class\n    ufo_data$datetime <- as.Date(ufo_data$datetime, format = \"%m/%d/%Y\")\n    \n    # Create a time series for the total number of sightings over the years\n    ufo_year_data <- ufo_data %>%\n      group_by(year = lubridate::year(datetime)) %>%\n      summarize(total_reports = n())\n    \n    # Create the plot -  we can change the number of years shown by changing the scale\n    ggplot(ufo_year_data, aes(x = year, y = total_reports)) +\n      geom_line() +\n      labs(title = \"Total Number of UFO Sighting Reports Over the Years\", x = \"Year\", y = \"Total Reports\") +\n      scale_x_continuous(breaks = seq(min(ufo_year_data$year), max(ufo_year_data$year)+10, by = 10 )) \n    ```\n    \n    ::: {.cell-output-display}\n    ![](challenge_5_Fall23_files/figure-html/unnamed-chunk-3-1.png){width=672}\n    :::\n    \n    ```{.r .cell-code}\n      #theme(axis.text.x = element_text(angle = -90, hjust = 1))\n    ```\n    :::\n\n\n    \\(2\\) the total number of UFO sighting reports by months between 2010-01-01 and 2014-01-01. **(15%)**\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #UFO sighting reports by months between 2010-01-01 and 2014-01-01.\n    ufo_month_data <- ufo_data %>%\n      filter(datetime >= as.Date('2010-01-01') & datetime <= as.Date('2014-01-01')) %>%\n      group_by(monthyear = floor_date(datetime, \"month\")) %>%\n      summarize(total_reports = n())\n    \n    \n    # Plotting the monthly data for the specified period\n    ggplot(ufo_month_data, aes(x = monthyear, y = total_reports)) +\n      geom_line() +\n      scale_x_date(date_breaks = \"1 month\", date_labels = \"%b %Y\") +\n      theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +\n          labs(title = \"Total Number of UFO Sighting Reports by Month (2010-01-01 to 2014-01-01)\", x = \"Year-Month\", y = \"Total Reports\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](challenge_5_Fall23_files/figure-html/unnamed-chunk-4-1.png){width=672}\n    :::\n    :::\n\n\n3.  Please write a paragraph describing the patterns you find on the two graphs above. **(10%)\\\n    Answer:\\\n    Plot1:\\\n    **We can observe from the first plot that the number of UFO sightings were very low from 1906 to 1992 but after that there is significant exponential rise in number of UFO sightings. In 2014, we can observe a drop again which might be due to incomplete data (the data has information only till May 2014). The rise in number maybe due to awareness among the people or technological advancements helping to record the reports better.\\\n    \\\n    **Plot2:**\\\n    When we plot the UFO sighting report count between 2010-01-01 and 2014-01-01, we can observe an interesting pattern. During a given year, number of reported sightings are low at the start and end of the year (During Jan, Feb, Nov, Dec etc) but there is a significant rise in reports during the middle of the year (mainly in the months of June and July).\\\n\n4.  **(Optional)** Use `gganimte` and `gifsky` packages to plot gifs of the above time-series plots. You can refer to codes and commands in the Week#8 demo file.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #yearly plot\n    ufo_yearly_plot_animated <- ggplot(ufo_year_data, aes(x = year, y = total_reports)) +\n      geom_line() +\n      geom_point() +\n      labs(title = \"Total Number of UFO Sighting Reports Over the Years\", x = \"Year\", y = \"Total Reports\") +\n      scale_x_continuous(breaks = seq(min(ufo_year_data$year), max(ufo_year_data$year)+10, by = 10 )) +\n      transition_reveal(year)\n    \n    animate(ufo_yearly_plot_animated, duration = 20, fps = 10, width = 500, height = 500, renderer = gifski_renderer())\n    ```\n    \n    ::: {.cell-output-display}\n    ![](challenge_5_Fall23_files/figure-html/unnamed-chunk-5-1.gif)\n    :::\n    \n    ```{.r .cell-code}\n    anim_save(\"UFOYearlyPlot.gif\")\n    ```\n    :::\n\n\n5.  **(Optional)** Suppose we are interested in describing the country variations in types and numbers of UFO sighting reports. How can we use bar plots to visualize the difference across countries (using the *country* column, you can recode the empty cells with \"others\")? **Note that you may need to do the data transformation or mutation needed to help graphing.**\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #type of your code/command here.\n    ufo_data_mod <- ufo_data %>%\n        mutate(country = ifelse(is.na(country), \"others\", country))\n    \n    \n    ufo_country_totals <- ufo_data_mod %>%\n      group_by(country) %>%\n      summarise(total_reports = n())\n    ggplot(data = ufo_country_totals, aes(x = factor(country), y = total_reports)) +\n          geom_bar(stat = \"identity\", color = \"black\", na.rm = TRUE) +\n          labs(title = \"Country wise UFO reports\", x = \"Country\", y = \"Number of reports\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](challenge_5_Fall23_files/figure-html/unnamed-chunk-6-1.png){width=672}\n    :::\n    \n    ```{.r .cell-code}\n    ggplot(ufo_data_mod, aes(x=factor(country), fill=factor(shape))) +\n          geom_bar(position=\"dodge\") +\n          labs(title=\"Shape variations for Countries\", x=\"Country\", y=\"Count\")\n    ```\n    \n    ::: {.cell-output-display}\n    ![](challenge_5_Fall23_files/figure-html/unnamed-chunk-6-2.png){width=672}\n    :::\n    :::\n\n\n## Part 2. The Haunted Places Data (50%) {#part-2.-the-haunted-places-data-50}\n\nThis data contains the reports of haunted places in the United States. The dataset was compiled by Tim Renner, using The Shadowlands Haunted Places Index, and shared on data.world. You can learn more about this data by checking: <https://www.kaggle.com/datasets/sujaykapadnis/haunted-places>\n\n1.  **Read and Describe the Data (10%) (Note: you don't need to remove the empty rows after the first row; `read_csv()` should automatically remove them).**\n\n    What is the dimension of the data? What do the columns mean? What is the unit of observation?\\\n    **Answer:\\\n    **The dimension of the data is 10992x10. There are 10992 rows and 10 columns.\\\n    \\\n    The columns present in the data are the following:\\\n    city - The city where the place is located.\\\n    country - The country where the place is located (always \"United States\")\\\n    description - A text description of the place.\\\n    location - A title for the haunted place.\\\n    state - The US state where the place is located.\\\n    state_abbrev - The two-letter abbreviation for the state.\\\n    longitude - Longitude of the place.\\\n    latitude - Latitude of the place.\\\n    city_longitude - Longitude of the city center.\\\n    city_latitude - Latitude of the city center.\n\n    The unit of observation here is a haunted place. Each row is a case and gives us information about the haunted place e.g., location.\\\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #reading data\n    haunted_places <- read_csv(\"./challenge5_data/haunted_places.csv\", show_col_types = FALSE)\n    \n    dim(haunted_places)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    [1] 10992    10\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    head(haunted_places)\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <div data-pagedtable=\"false\">\n      <script data-pagedtable-source type=\"application/json\">\n    {\"columns\":[{\"label\":[\"city\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"country\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"description\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"location\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"state\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"state_abbrev\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"longitude\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"latitude\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"city_longitude\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"city_latitude\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Ada\",\"2\":\"United States\",\"3\":\"Ada witch - Sometimes you can see a misty blue figure floating within a 3-mile radius of the Ada Cemetery on 2 Mile between Egypt Valley and Honey Creek. The story of her origin is as follows: A man suspected his wife of having an affair, so he followed her late one night when she thought he was asleep. Sure enough, she went to a field near their property where she met her lover. The husband was enraged and killed his wife, which resulted in a struggle with the other man. Both men died from their injuries. It is said that late at night (especially during the night of and the nights preceding a full moon) people driving by the field can see her ghost, searching for her lover. Some people have reported stopping to try to communicate with her, but she always disappears or runs into the woods where she cannot be followed (due to the thick brambles that inhabit the area). She is said to dress in a long white gown which authorities say dates her to the turn of the 20th century. Usually she is seen alone, but sometimes witnesses report seeing a ghostly death scene re-enacted... Others report seeing nothing at all but hearing the killer's shouts of rage followed by the victims' screams of agony... Although it is said she haunts the field on Honeycreek Road where she died, other witnesses have reported her in nearby Seidman Park, and in nearby Findlay Cemetery, where she is supposedly buried. This story was actually featured in the book \\\"Ghosts of Grand Rapids.\\\"\",\"4\":\"Ada Cemetery\",\"5\":\"Michigan\",\"6\":\"MI\",\"7\":\"-85.50489\",\"8\":\"42.96211\",\"9\":\"-85.49548\",\"10\":\"42.96073\"},{\"1\":\"Addison\",\"2\":\"United States\",\"3\":\"A little girl was killed suddenly while waiting for a school bus by a speeding car. Since her death things have happened. The day of her funeral she started knocking on doors of the house she was born in.1 month later as her clothes were to be removed the doors in the home flew open with no reason. Cold spots now can be felt & knocking at the door is still present to this day in the home. Also when there swings in the yard you could see them swing real high as if someone was swinging on them. lights like to go on & off in this home & she does move things to let someone know she is there. The cemetery where this child lies has had alot of activity also. When you visit her grave she has a twirly that will start going around & round with no reason or wind blowing to let you know she is present. Some have said she has been spotted walking the cemetery very restless as if she doesn't realize she has passed on.\",\"4\":\"North Adams Rd.\",\"5\":\"Michigan\",\"6\":\"MI\",\"7\":\"-84.38184\",\"8\":\"41.97142\",\"9\":\"-84.34717\",\"10\":\"41.98643\"},{\"1\":\"Adrian\",\"2\":\"United States\",\"3\":\"If you take Gorman Rd. west towards Sand Creek, you will come to a gravel road leading north. A mile or so up this road you will come to narrow one lane trestle bridge. The road goes under this. Legend has it that at one time there was a farm house built near the tracks. Late one night a fire broke out in the barn. While the father ran to the barn to try to get the horses out, his wife and young son went to the tracks to wave down one of the many trains that would use that right of way. They were too close to the tracks however and both were struck by the train as it went past. The father was killed in the barn. Now if you go out there late at night, you can sometimes communicate with the Father. He will not allow you to talk to his wife or son; as if he was protecting them . There are other people living in the area now, and a large streetlight has been placed there by the people who own the neighboring land. If you stay there to long, they will call the police. However if you make your visit short enough they will usually leave you to it. This place has also been described as a good place to go to contact other spirits. The Father can be asked to help in this matter. He will not allow antagonistic spirits to talk however; once again to protect his family.\",\"4\":\"Ghost Trestle\",\"5\":\"Michigan\",\"6\":\"MI\",\"7\":\"-84.03566\",\"8\":\"41.90454\",\"9\":\"-84.03717\",\"10\":\"41.89755\"},{\"1\":\"Adrian\",\"2\":\"United States\",\"3\":\"In the 1970's, one room, room 211, in the old section of the dorms exhibited several phenomena. Don't know if this still continues today. The door into the room from the hallway, as well as the door into the bathroom, would open and shut on their own, the main door even if it had been locked. After closing, it would be locked again. There was also a spot on one wall (a wall that the room shared with a boarded up, no longer used laundry shaft) where two points of light would appear, shaped similar to eyes. Attempts were made to explain their appearance (they were visible any time it was dark in the room). They were screened off from the windows to see if they might be reflections, they weren't. When objects were placed between them and the windows they actually became brighter. We tried painting the walls, putting several coats of paint over them (thinking they may have been a joke of a previous resident, made with glow in the dark paint) - also having used sandpaper on the wall in that spot first before painting. They still appeared bright as ever after the painting. We tried covering them over by hanging a picture over them, but the picture kept falling down or moving. Last attempt to hang picture (it was a drawing on a piece of paper and simply taped to the wall) resulted in us waking up the next morning to find it taped to the ceiling over my bed. We finally moved a tall dresser in front of it and that seemed to take care of it. Reports from later residents told us that they had placed a mirror over it, and they had a rocker in the room. One night during a party, with several witnesses, the rocker began rocking on its own, then flew back and smashed the mirror. Have had no contact with the school since graduation, so don't know if these things still happen or not.\",\"4\":\"Siena Heights University\",\"5\":\"Michigan\",\"6\":\"MI\",\"7\":\"-84.01757\",\"8\":\"41.90571\",\"9\":\"-84.03717\",\"10\":\"41.89755\"},{\"1\":\"Albion\",\"2\":\"United States\",\"3\":\"Kappa Delta Sorority - The Kappa Delta Sorority is haunted by an entity simply known as 'P'. It is said she was a sister there who died in a car accident. Current sisters there have reported hearing giggling and running around coming from the upstairs floor while they are in the basement. At one time a sister called out to \\\"P\\\" and received a \\\"hello\\\" in reply.\",\"4\":\"Albion College\",\"5\":\"Michigan\",\"6\":\"MI\",\"7\":\"-84.74518\",\"8\":\"42.24401\",\"9\":\"-84.75303\",\"10\":\"42.24310\"},{\"1\":\"Albion\",\"2\":\"United States\",\"3\":\"A mysterious lady in white has been spotted in this cemetery.\",\"4\":\"Riverside Cemetery\",\"5\":\"Michigan\",\"6\":\"MI\",\"7\":\"-84.75306\",\"8\":\"42.23681\",\"9\":\"-84.75303\",\"10\":\"42.24310\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n      </script>\n    </div>\n    `````\n    :::\n    \n    ```{.r .cell-code}\n    colnames(haunted_places)\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n     [1] \"city\"           \"country\"        \"description\"    \"location\"      \n     [5] \"state\"          \"state_abbrev\"   \"longitude\"      \"latitude\"      \n     [9] \"city_longitude\" \"city_latitude\" \n    ```\n    :::\n    :::\n\n\n2.  Plot a USA map with states boundaries. There are multiple ways of plotting this map. **(15%)**\n\n    You can use the `geom_polygon()` (which requires a data of spatial coordinates for plotting a polygon), or you can use `geom_sf()` (which requires a shapefile of the US). Please refer to the examples in the Week#8 demo file.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    states_sf<-st_read(\"./challenge5_data/States_shapefile.shp\")\n    ```\n    \n    ::: {.cell-output .cell-output-stdout}\n    ```\n    Reading layer `States_shapefile' from data source \n      `E:\\UMASS_Acads\\Sem3\\601DACCS\\DACSS601\\challenge5_data\\States_shapefile.shp' \n      using driver `ESRI Shapefile'\n    Simple feature collection with 51 features and 6 fields\n    Geometry type: MULTIPOLYGON\n    Dimension:     XY\n    Bounding box:  xmin: -178.2176 ymin: 18.92179 xmax: -66.96927 ymax: 71.40624\n    Geodetic CRS:  WGS 84\n    ```\n    :::\n    \n    ```{.r .cell-code}\n    usa_map<-ggplot()+\n      geom_sf(data = states_sf)+\n      coord_sf(xlim = c(-180, -65), ylim = c(20, 70))+\n      theme_light() +\n      labs(title = \"USA Map with State Boundaries\")\n    \n    print(usa_map)\n    ```\n    \n    ::: {.cell-output-display}\n    ![](challenge_5_Fall23_files/figure-html/unnamed-chunk-8-1.png){width=672}\n    :::\n    :::\n\n\n3.  Plot the haunted places using the *city_longtitude* and *city_latitude* with `geom_point()` on the USA map generated above. **(15%)**\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #type of your code/command here.\n    haunted_places_map<-ggplot()+\n      geom_sf(data = states_sf)+\n      geom_point(data = haunted_places, aes(x = city_longitude, y = city_latitude), pch = 19, size=0.00005, na.rm = TRUE )+\n      coord_sf(xlim = c(-180, -65), ylim = c(20, 70)) +\n      theme_light() +\n      labs(title = \"Location of haunted places on USA Map\")\n    \n    print(haunted_places_map)\n    ```\n    \n    ::: {.cell-output-display}\n    ![](challenge_5_Fall23_files/figure-html/unnamed-chunk-9-1.png){width=672}\n    :::\n    :::\n\n\n4.  Please write a paragraph describing the pattern of the haunted spaces you find on the map above. **(10%)\\\n    Answer:\\\n    **We can observe from the above plot that the Eastern part of USA has more haunted places than the Western plot. States wise, California has the highest number of haunted places and Alaska has the lowest number of haunted places. And there seems to be more density of haunted places near the coastal regions.\n\n\n    ::: {.cell}\n    \n    ```{.r .cell-code}\n    #type of your code/command here.\n    haunted_places %>%\n      group_by(state) %>%\n      summarise(Number_of_places = n()) %>%\n      arrange(desc(Number_of_places))\n    ```\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <div data-pagedtable=\"false\">\n      <script data-pagedtable-source type=\"application/json\">\n    {\"columns\":[{\"label\":[\"state\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Number_of_places\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"California\",\"2\":\"1070\"},{\"1\":\"Texas\",\"2\":\"696\"},{\"1\":\"Pennsylvania\",\"2\":\"649\"},{\"1\":\"Michigan\",\"2\":\"529\"},{\"1\":\"Ohio\",\"2\":\"477\"},{\"1\":\"New York\",\"2\":\"459\"},{\"1\":\"Illinois\",\"2\":\"395\"},{\"1\":\"Kentucky\",\"2\":\"370\"},{\"1\":\"Indiana\",\"2\":\"351\"},{\"1\":\"Massachusetts\",\"2\":\"342\"},{\"1\":\"Florida\",\"2\":\"328\"},{\"1\":\"Missouri\",\"2\":\"314\"},{\"1\":\"Georgia\",\"2\":\"289\"},{\"1\":\"Wisconsin\",\"2\":\"274\"},{\"1\":\"Alabama\",\"2\":\"224\"},{\"1\":\"Tennessee\",\"2\":\"221\"},{\"1\":\"Washington\",\"2\":\"218\"},{\"1\":\"North Carolina\",\"2\":\"211\"},{\"1\":\"Oklahoma\",\"2\":\"211\"},{\"1\":\"New Jersey\",\"2\":\"194\"},{\"1\":\"Virginia\",\"2\":\"192\"},{\"1\":\"Connecticut\",\"2\":\"185\"},{\"1\":\"Maryland\",\"2\":\"170\"},{\"1\":\"Iowa\",\"2\":\"169\"},{\"1\":\"South Carolina\",\"2\":\"168\"},{\"1\":\"Colorado\",\"2\":\"166\"},{\"1\":\"Minnesota\",\"2\":\"162\"},{\"1\":\"Arizona\",\"2\":\"156\"},{\"1\":\"Oregon\",\"2\":\"155\"},{\"1\":\"Utah\",\"2\":\"134\"},{\"1\":\"Kansas\",\"2\":\"123\"},{\"1\":\"Arkansas\",\"2\":\"119\"},{\"1\":\"Nebraska\",\"2\":\"111\"},{\"1\":\"West Virginia\",\"2\":\"106\"},{\"1\":\"Louisiana\",\"2\":\"99\"},{\"1\":\"Hawaii\",\"2\":\"96\"},{\"1\":\"New Mexico\",\"2\":\"78\"},{\"1\":\"Wyoming\",\"2\":\"76\"},{\"1\":\"South Dakota\",\"2\":\"75\"},{\"1\":\"New Hampshire\",\"2\":\"72\"},{\"1\":\"Rhode Island\",\"2\":\"68\"},{\"1\":\"Idaho\",\"2\":\"66\"},{\"1\":\"Mississippi\",\"2\":\"63\"},{\"1\":\"Vermont\",\"2\":\"63\"},{\"1\":\"North Dakota\",\"2\":\"58\"},{\"1\":\"Maine\",\"2\":\"57\"},{\"1\":\"Nevada\",\"2\":\"56\"},{\"1\":\"Montana\",\"2\":\"42\"},{\"1\":\"Delaware\",\"2\":\"37\"},{\"1\":\"Alaska\",\"2\":\"32\"},{\"1\":\"Washington DC\",\"2\":\"16\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n      </script>\n    </div>\n    `````\n    :::\n    :::\n",
    "supporting": [
      "challenge_5_Fall23_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}